import{c as e}from"./UserApi-253232f7.js";import"./findPassword-042e4c3c.js";import{c as a,C as l,I as t,d as s}from"./IconDropDown-8d9141bd.js";import{e as i,m as o,o as r,c as u,d as p,t as n,j as d,p as c,b as m,q as f,r as g,C as h,u as v,A as y,h as b,k as _,F as k,B as I,H as V,E as L,g as P,J as x,L as j,M as T,S as w,U,R as z,K as B,I as C}from"./index-b5355031.js";import{_ as A}from"./_plugin-vue_export-helper-1b428a4d.js";import"./logo_head-4a1e4f8c.js";const D={class:"back"},E={class:"icon"},R=[(e=>(c("data-v-2b9d39ca"),e=e(),m(),e))((()=>p("use",{href:"#fanhui"},null,-1)))],S={key:0},q=A(i({__name:"back",props:{title:{type:String},isEmit:{type:Boolean,default:!1}},emits:["onBack"],setup(e,{emit:a}){const l=e,t=o(),s=()=>{l.isEmit?a("onBack"):t.back()};return(e,a)=>(r(),u("div",D,[p("div",E,[(r(),u("svg",{class:"iconpark-icon",onClick:s},R))]),l.title?(r(),u("h3",S,n(l.title),1)):d("",!0)]))}}),[["__scopeId","data-v-2b9d39ca"]]),F=e=>(c("data-v-6d9a2d71"),e=e(),m(),e),G=F((()=>p("svg",{class:"iconpark-icon"},[p("use",{href:"#gouxuan"})],-1))),J=["onClick"],M=[F((()=>p("use",{href:"#shangchuantupian-guanbianniu"},null,-1)))],H=F((()=>p("svg",{class:"iconpark-icon"},[p("use",{href:"#shangchuan"})],-1))),K=F((()=>p("div",null,"Upload images",-1))),N=["src"],Y=A(i({__name:"share_edit",setup(i){const d=f(),c=o();let m=d.params.id?d.params.id:"";const A=e+"/upload",D=g(),E=[{value:"1",label:"Midjourney"},{value:"2",label:"DALL·E"},{value:"3",label:"Stable Diffusion"}],R=h({title:"",prompt:"",aiPrompt:"",aiType:"1",introduction:"",fileList:[],fileIds:[]}),S=h({title:[{required:!0,message:"Please input title",trigger:"blur"}],prompt:[{required:!0,message:"Please input your prompt",trigger:"blur"}]}),F={Authorization:v().getToken},Y=g(""),O=g(!1),Q=e=>{let a=W(e.uid);-1!==a&&(R.fileList.splice(a,1),R.fileIds.splice(a,1))},W=e=>{let a=-1;for(let l=0;l<R.fileList.length;l++)if(R.fileList[l].uid==e){a=l;break}return a},X=e=>{Y.value=e.url,O.value=!0},Z=e=>!(e.size/1024/1024>2)||(I.error("Picture size can not exceed 2MB!"),!1),$=(e,a)=>{R.fileIds.push(e.result.fileId)};return y((()=>{a(m).then((e=>{if(200==e.code){R.title=e.result.title,R.prompt=e.result.prompt,R.aiType=e.result.aiType,R.introduction=e.result.introduction,R.fileList=e.result.images;for(let e=0;e<R.fileList.length;e++)R.fileIds.push(R.fileList[e].uid)}else I({message:e.message,type:"error",duration:3e3})}))})),(e,a)=>{const i=j,o=T,d=w,f=U,g=z,h=B,v=C,y=V,W=L;return r(),u(k,null,[b(l),b(q,{title:"Share Your Art"}),b(y,{ref_key:"ruleFormRef",ref:D,model:R,rules:S,class:"ruleForm","label-position":"top"},{default:_((()=>[b(o,{prop:"title"},{default:_((()=>[b(i,{modelValue:R.title,"onUpdate:modelValue":a[0]||(a[0]=e=>R.title=e),placeholder:"Title",autocomplete:"off"},null,8,["modelValue"])])),_:1}),b(o,{prop:"prompt"},{default:_((()=>[b(i,{modelValue:R.prompt,"onUpdate:modelValue":a[1]||(a[1]=e=>R.prompt=e),type:"textarea",class:"textarea",autocomplete:"off",autosize:{minRows:4},placeholder:"please use “ , ” to separate the prompt, ex: a, cute, dog, HDR "},null,8,["modelValue"])])),_:1}),b(o,{prop:"aiType"},{default:_((()=>[b(f,{modelValue:R.aiType,"onUpdate:modelValue":a[2]||(a[2]=e=>R.aiType=e),class:"m-2",placeholder:"Select",size:"large","popper-class":"blueBack","suffix-icon":t},{default:_((()=>[(r(),u(k,null,P(E,(e=>b(d,{key:e.value,label:e.label,value:e.value},{default:_((()=>[x(n(e.label),1),G])),_:2},1032,["label","value"]))),64))])),_:1},8,["modelValue"])])),_:1}),b(h,{action:A,"file-list":R.fileList,"onUpdate:fileList":a[3]||(a[3]=e=>R.fileList=e),"list-type":"picture-card","on-preview":X,"on-remove":Q,headers:F,"before-upload":Z,"on-success":$,class:"upload-wrap",accept:".jpg,.jpeg,.png,.gif,.JPG,.PNG,.JPEG"},{file:_((({file:e})=>[b(g,{class:"thumbnail",src:e.url,fit:"cover"},null,8,["src"]),(r(),u("svg",{class:"iconpark-icon",onClick:a=>Q(e)},M,8,J))])),default:_((()=>[H,K])),_:1},8,["file-list"]),b(o,{prop:"introduction"},{default:_((()=>[b(i,{modelValue:R.introduction,"onUpdate:modelValue":a[4]||(a[4]=e=>R.introduction=e),type:"textarea",class:"textarea",autocomplete:"off",autosize:{minRows:4},placeholder:"Introduction of your art...(optional)"},null,8,["modelValue"])])),_:1}),b(v,{type:"primary",class:"submit",size:"large",onClick:a[5]||(a[5]=e=>(async e=>{e&&await e.validate(((e,a)=>{if(e){if(0==R.fileIds.length)return I({message:"Please upload a image",type:"error",duration:3e3}),!1;let e={promptId:m,title:R.title,prompt:R.prompt,aiPrompt:R.aiPrompt,aiType:R.aiType,introduction:R.introduction,fileIds:R.fileIds};s(e).then((e=>{200==e.code?c.push({path:"/account/share"}):I({message:e.message,type:"error",duration:3e3})}))}}))})(D.value))},{default:_((()=>[x("done")])),_:1})])),_:1},8,["model","rules"]),b(W,{modelValue:O.value,"onUpdate:modelValue":a[6]||(a[6]=e=>O.value=e)},{default:_((()=>[p("img",{"w-full":"",src:Y.value,alt:"Preview Image"},null,8,N)])),_:1},8,["modelValue"])],64)}}}),[["__scopeId","data-v-6d9a2d71"]]);export{Y as default};
